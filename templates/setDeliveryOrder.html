{% extends "menu.html" %} {% block title %}Checkout Page{% endblock %}
{%block content %}
<script>
  function onSubmit(customerID, orderID, deliveryPersonID) {
    // Send a POST request to the server
    var deliveryPerson = document.getElementById("deliveryPersonID");
    var item = {
        customerID: customerID,
        orderID: orderID,
        deliveryPersonID: deliveryPersonID}
    fetch('/setDelivery', {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json'
      },
      body: JSON.stringify(item)
    })
    .then(response => response.json())
    .then(data => {
      alert(data.message);
      deliveryPerson.innerHTML = deliveryPersonID;
    })
    .catch(error => {
      console.error('Error:', error);
      console.log(item);
    });
  }
</script>
<table>
    <tr>
        <th>orderId</th>
        <th>orderFood</th>
        <th>Price</th>
        <th>status</th>
        <th>deliveryAddress</th>
        <th>orderDate</th>
        <th>deliveryPerson</th>
    </tr>
    <tr>
        <td>{{order.orderId}}</td>
        <td>
            {%for food in order.orderFood%}
            {%for item in foods%}
            {%if item.id == food.foodId%}
            <p>{{item.name}} x {{food.quantity}}</p>
            {%endif%}
            {%endfor%}
            {%endfor%}
        </td>
        <td>${{order.total}}</td>
        <td>{{order.status}}</td>
        <td>{{order.deliveryAddress}}</td>
        <td>{{order.orderDate}}</td>
        <td id="deliveryPersonID">{{order.deliveryPersonID}}</td>
    </tr>    
</table>
{% for deliveryPerson in deliveryPersons %}
<a>
    <label>{{deliveryPerson.name}}</label>
    <label>{{deliveryPerson.email}}</label>
    <label>{{deliveryPerson.phone}}</label>
    <input type="button" value="deliveryPerson" onclick="onSubmit('{{customer}}', {{order.orderId}}, '{{deliveryPerson.id}}')">
</a><br>
{% endfor %}
{% endblock %}